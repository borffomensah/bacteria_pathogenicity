import streamlit as st
import pandas as pd
import joblib
import os

# --- PAGE CONFIG ---
st.set_page_config(
    page_title="Pathogenicity Predictor",
    page_icon="üß¨",
    layout="wide"
)

# --- IMAGE DATA ---
# This is the base64 string you provided
DNA_IMAGE = "data:image/jpeg;base64,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"

# --- LOAD MODEL ---
@st.cache_resource
def load_trained_model():
    model_path = 'genom.pkl'
    if os.path.exists(model_path):
        try:
            return joblib.load(model_path)
        except ModuleNotFoundError:
            st.error("Error: 'scikit-learn' is not installed. Please add it to your requirements.txt.")
            return None
    else:
        st.warning(f"Model file '{model_path}' not found.")
        return None

model = load_trained_model()

# --- HEADER ---
st.title('üß¨ Pathogenicity Prediction App')
st.markdown("""
Predict whether a bacterial genome is **Pathogenic** or **Non-Pathogenic** based on genomic features.
""")
st.divider()

# --- SIDEBAR INPUTS ---
with st.sidebar:
    st.header('üî¨ Feature Input')
    gc_content = st.slider('GC Content (%)', 45.0, 55.0, 50.0, 0.01)
    genome_size = st.number_input('Genome Size', 1000000, 10000000, 5000000, 10000)
    virulence = st.number_input('Virulence Score', 0, 1000, 300)
    amr_gene = st.number_input('AMR Gene Count', 0, 500, 250)
    
    st.divider()
    with st.expander("‚ÑπÔ∏è About GC Content"):
        st.write("GC content is the percentage of nitrogenous bases in DNA that are Guanine or Cytosine.")
        st.image(DNA_IMAGE, use_container_width=True)

# --- MAIN PAGE LAYOUT ---
col1, col2 = st.columns([1, 1])

with col1:
    st.subheader("Current Input Data")
    input_data = pd.DataFrame(
        [[gc_content, genome_size, virulence, amr_gene]],
        columns=['GC_content_percentage', 'Genome_size', 'Virulence', 'AMR_gene']
    )
    st.table(input_data)

with col2:
    st.subheader("Prediction Dashboard")
    
    if model is None:
        st.info("Please ensure the model is loaded correctly to see results.")
    else:
        if st.button('üöÄ Predict Pathogenicity', use_container_width=True):
            prediction = model.predict(input_data)
            prediction_proba = model.predict_proba(input_data)[0]

            # Show Result
            if prediction[0] == 1:
                st.error(f"### Result: Pathogenic")
                st.metric("Confidence Score", f"{prediction_proba[1]:.2%}")
            else:
                st.success(f"### Result: Non-Pathogenic")
                st.metric("Confidence Score", f"{prediction_proba[0]:.2%}")

            # Probability Breakdown
            st.divider()
            st.write("**Probability Distribution:**")
            prob_df = pd.DataFrame({
                "Category": ["Non-Pathogenic", "Pathogenic"],
                "Probability": [prediction_proba[0], prediction_proba[1]]
            })
            st.bar_chart(prob_df.set_index("Category"))

st.divider()
st.caption('Development Note: This application is for genomic research simulation purposes.')